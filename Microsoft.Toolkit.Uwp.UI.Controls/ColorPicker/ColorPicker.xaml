<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
                    xmlns:primitives="using:Microsoft.Toolkit.Uwp.UI.Controls.Primitives"
                    xmlns:converters="using:Microsoft.Toolkit.Uwp.UI.Converters"
                    xmlns:ex="using:Microsoft.Toolkit.Uwp.UI.Extensions"
                    xmlns:localconverters="using:Microsoft.Toolkit.Uwp.UI.Controls.ColorPickerConverters">

    <SolidColorBrush x:Key="CheckerboardColor0">
        <SolidColorBrush.Color>
            <Color>Transparent</Color>
        </SolidColorBrush.Color>
    </SolidColorBrush>
    <SolidColorBrush x:Key="CheckerboardColor1">
        <SolidColorBrush.Color>
            <Color>#70F5F5F5</Color>
        </SolidColorBrush.Color>
    </SolidColorBrush>
    <SolidColorBrush x:Name="CheckerColorBrush"
                     Color="{ThemeResource SystemListLowColor}" />

    <Style BasedOn="{StaticResource DefaultColorPickerStyle}"
           TargetType="controls:ColorPicker" />

    <Style x:Key="DefaultColorPickerStyle"
           TargetType="controls:ColorPicker">
        <Setter Property="Width" Value="346" />
        <Setter Property="MinWidth" Value="312" />
        <Setter Property="MinHeight" Value="392" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="CornerRadius" Value="{ThemeResource ControlCornerRadius}" />
        <Setter Property="Template" Value="{StaticResource ColorPickerTemplate}" />
    </Style>

    <localconverters:ContrastBrushConverter x:Key="ContrastBrushConverter" />

    <ControlTemplate x:Key="ColorPickerTemplate"
                     TargetType="controls:ColorPicker">
        <Grid Margin="{TemplateBinding Padding}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}">
            <Grid.Resources>
                <localconverters:ColorToColorShadeConverter x:Key="ColorToColorShadeConverter" />
                <converters:ColorToDisplayNameConverter x:Key="ColorToDisplayNameConverter" />
                <localconverters:ColorToHexConverter x:Key="ColorToHexConverter" />

                <Style x:Key="InputTextBoxStyle"
                       TargetType="TextBox">
                    <Setter Property="CornerRadius" Value="0,2,2,0" />
                    <!--  TODO: Is there a theme resource we can use for this from the system?  -->
                </Style>
            </Grid.Resources>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <!--
                The whole background of the pivot header is changed here.
                It's much easier to do this than customize the PivotHeaderItem template.
                Remember PivotHeaderItem has a default height of 48px.
            -->
            <Border Grid.Row="0"
                    Height="48"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Top"
                    Background="{ThemeResource SystemControlAcrylicElementBrush}"
                    CornerRadius="4" />
            <ListBox x:Name="ColorPanelSelector"
                     Grid.Row="0"
                     HorizontalAlignment="Center"
                     Background="Transparent"
                     ItemContainerStyle="{StaticResource UnderlineListBoxItemStyle}">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBoxItem x:Name="SpectrumListBoxItem"
                             AutomationProperties.Name="Spectrum"
                             IsSelected="True">
                    <!--  TODO: Add These via x:Uid  -->
                    <FontIcon Glyph="&#xE76D;" />
                </ListBoxItem>
                <ListBoxItem x:Name="PaletteListBoxItem"
                             AutomationProperties.Name="Palette">
                    <FontIcon Glyph="&#xE790;" />
                </ListBoxItem>
                <ListBoxItem x:Name="ChannelsListBoxItem"
                             AutomationProperties.Name="Channels">
                    <FontIcon Glyph="&#xE9E9;" />
                </ListBoxItem>
            </ListBox>
            <controls:SwitchPresenter x:Name="ContentContainer"
                                      Grid.Row="1"
                                      Margin="12"
                                      Value="{Binding ElementName=ColorPanelSelector, Path=SelectedItem.Name}">
                <controls:Case Value="SpectrumListBoxItem">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"
                                              MinWidth="32" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto"
                                              MinWidth="32" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <primitives:ColorPickerSlider x:Name="ColorSpectrumThirdDimensionSlider"
                                                      Grid.Row="1"
                                                      Grid.RowSpan="2"
                                                      Grid.Column="0"
                                                      Width="20"
                                                      Margin="0,0,12,0"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Stretch"
                                                      DefaultForeground="{ThemeResource TextControlForeground}"
                                                      Orientation="Vertical" />
                        <!--  Keep in mind the spectrum is always HSV  -->
                        <!--  This must also not be named 'ColorSpectrum' to differentiate from the base class  -->
                        <ColorSpectrum x:Name="ColorSpectrumControl"
                                       Grid.Row="0"
                                       Grid.RowSpan="2"
                                       Grid.Column="1"
                                       MinWidth="256"
                                       MinHeight="256"
                                       HorizontalAlignment="Stretch"
                                       VerticalAlignment="Stretch"
                                       AutomationProperties.Name="Third Dimension"
                                       Components="{TemplateBinding ColorSpectrumComponents}"
                                       MaxHue="{TemplateBinding MaxHue}"
                                       MaxSaturation="{TemplateBinding MaxSaturation}"
                                       MaxValue="{TemplateBinding MaxValue}"
                                       MinHue="{TemplateBinding MinHue}"
                                       MinSaturation="{TemplateBinding MinSaturation}"
                                       MinValue="{TemplateBinding MinValue}"
                                       Shape="{TemplateBinding ColorSpectrumShape}" />
                        <primitives:ColorPickerSlider x:Name="ColorSpectrumAlphaSlider"
                                                      Grid.Row="1"
                                                      Grid.RowSpan="2"
                                                      Grid.Column="2"
                                                      Width="20"
                                                      Margin="12,0,0,0"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Stretch"
                                                      AutomationProperties.Name="Alpha Channel"
                                                      DefaultForeground="{ThemeResource TextControlForeground}"
                                                      Orientation="Vertical" />
                    </Grid>
                </controls:Case>
                <controls:Case Value="PaletteListBoxItem">
                    <GridView Margin="0"
                              Padding="0"
                              ItemContainerStyle="{StaticResource PaletteGridViewItemStyle}"
                              ItemsSource="{TemplateBinding CustomPaletteColors}"
                              SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Mode=TwoWay}"
                              SelectionMode="Single"
                              Tag="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Mode=OneWay}">
                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <controls:UniformGrid ex:FrameworkElementExtensions.AncestorType="controls:ColorPicker"
                                                      Columns="{Binding (ex:FrameworkElementExtensions.Ancestor).CustomPaletteColumnCount, RelativeSource={RelativeSource Self}}" />
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>
                        <GridView.ItemTemplate>
                            <DataTemplate>
                                <Border HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch"
                                        AutomationProperties.Name="{Binding Converter={StaticResource ColorToDisplayNameConverter}}"
                                        ToolTipService.ToolTip="{Binding Converter={StaticResource ColorToDisplayNameConverter}}">
                                    <Border.Background>
                                        <SolidColorBrush Color="{Binding}" />
                                    </Border.Background>
                                </Border>
                            </DataTemplate>
                        </GridView.ItemTemplate>
                    </GridView>
                </controls:Case>
                <controls:Case Value="ChannelsListBoxItem">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30" />
                            <ColumnDefinition Width="80" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="24" />
                            <RowDefinition Height="1*" />
                            <RowDefinition Height="1*" />
                            <RowDefinition Height="1*" />
                            <RowDefinition Height="1*" />
                            <!--  Note that there is an additional 12px added by the PivotItem  -->
                            <RowDefinition Height="12" />
                        </Grid.RowDefinitions>
                        <!--  Top color model & Hex input  -->
                        <Grid Grid.Row="0"
                              Grid.Column="0"
                              Grid.ColumnSpan="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="12" />
                                <ColumnDefinition Width="2*" />
                            </Grid.ColumnDefinitions>
                            <!--  Content RGB/HSV names are hard-coded in ColorPicker as well  -->
                            <!--  ToggleButtons are styled to look like a 'SegmentedControl' or 'ButtonGroup'  -->
                            <ToggleButton x:Name="RgbToggleButton"
                                          Grid.Column="0"
                                          HorizontalAlignment="Stretch"
                                          Background="Transparent"
                                          BorderBrush="{ThemeResource ToggleButtonBackgroundChecked}"
                                          BorderThickness="1"
                                          Content="RGB"
                                          CornerRadius="2,0,0,2"
                                          IsThreeState="False" />
                            <ToggleButton x:Name="HsvToggleButton"
                                          Grid.Column="1"
                                          HorizontalAlignment="Stretch"
                                          Background="Transparent"
                                          BorderBrush="{ThemeResource ToggleButtonBackgroundChecked}"
                                          BorderThickness="1"
                                          Content="HSV"
                                          CornerRadius="0,2,2,0"
                                          IsThreeState="False" />
                            <Grid x:Name="HexInputGrid"
                                  Grid.Column="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0"
                                        Height="32"
                                        Background="{ThemeResource TextBoxDisabledBackgroundThemeBrush}"
                                        BorderBrush="{ThemeResource TextControlBorderBrush}"
                                        BorderThickness="1,1,0,1"
                                        CornerRadius="2,0,0,2">
                                    <TextBlock HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               FontWeight="SemiBold"
                                               Foreground="{ThemeResource TextBoxDisabledForegroundThemeBrush}"
                                               Text="#" />
                                </Border>
                                <!--  Name must NOT match what is in ColorPicker 'HexTextBox'  -->
                                <TextBox x:Name="HexInputTextBox"
                                         Grid.Column="1"
                                         Height="32"
                                         HorizontalAlignment="Stretch"
                                         AutomationProperties.Name="Hexadecimal Color Input"
                                         Style="{StaticResource InputTextBoxStyle}" />
                            </Grid>
                        </Grid>
                        <!--  Color channel editing controls  -->
                        <!--  Channel 1 RGB:Red HSV:Hue  -->
                        <Border Grid.Row="2"
                                Grid.Column="0"
                                Height="{Binding ElementName=Channel1TextBox, Path=ActualHeight}"
                                VerticalAlignment="Center"
                                Background="{ThemeResource TextBoxDisabledBackgroundThemeBrush}"
                                BorderBrush="{ThemeResource TextControlBorderBrush}"
                                BorderThickness="1,1,0,1"
                                CornerRadius="2,0,0,2">
                            <TextBlock x:Name="Channel1TextBlock"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       FontWeight="SemiBold"
                                       Foreground="{ThemeResource TextBoxDisabledForegroundThemeBrush}"
                                       Text="R" />
                        </Border>
                        <TextBox x:Name="Channel1TextBox"
                                 Grid.Row="2"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 AutomationProperties.Name="Red Channel"
                                 Style="{StaticResource InputTextBoxStyle}" />
                        <primitives:ColorPickerSlider x:Name="Channel1Slider"
                                                      Grid.Row="2"
                                                      Grid.Column="2"
                                                      Margin="12,0,0,0"
                                                      HorizontalAlignment="Stretch"
                                                      VerticalAlignment="Center"
                                                      AutomationProperties.Name="Red Channel"
                                                      DefaultForeground="{ThemeResource TextControlForeground}" />
                        <!--  Channel 2 RGB:Green HSV:Saturation  -->
                        <Border Grid.Row="3"
                                Grid.Column="0"
                                Height="{Binding ElementName=Channel2TextBox, Path=ActualHeight}"
                                VerticalAlignment="Center"
                                Background="{ThemeResource TextBoxDisabledBackgroundThemeBrush}"
                                BorderBrush="{ThemeResource TextControlBorderBrush}"
                                BorderThickness="1,1,0,1"
                                CornerRadius="2,0,0,2">
                            <TextBlock x:Name="Channel2TextBlock"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       FontWeight="SemiBold"
                                       Foreground="{ThemeResource TextBoxDisabledForegroundThemeBrush}"
                                       Text="G" />
                        </Border>
                        <TextBox x:Name="Channel2TextBox"
                                 Grid.Row="3"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 AutomationProperties.Name="Green Channel"
                                 Style="{StaticResource InputTextBoxStyle}" />
                        <primitives:ColorPickerSlider x:Name="Channel2Slider"
                                                      Grid.Row="3"
                                                      Grid.Column="2"
                                                      Margin="12,0,0,0"
                                                      HorizontalAlignment="Stretch"
                                                      VerticalAlignment="Center"
                                                      AutomationProperties.Name="Green Channel"
                                                      DefaultForeground="{ThemeResource TextControlForeground}" />
                        <!--  Channel 3 RGB:Blue HSV:Value  -->
                        <Border Grid.Row="4"
                                Grid.Column="0"
                                Height="{Binding ElementName=Channel3TextBox, Path=ActualHeight}"
                                VerticalAlignment="Center"
                                Background="{ThemeResource TextBoxDisabledBackgroundThemeBrush}"
                                BorderBrush="{ThemeResource TextControlBorderBrush}"
                                BorderThickness="1,1,0,1"
                                CornerRadius="2,0,0,2">
                            <TextBlock x:Name="Channel3TextBlock"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       FontWeight="SemiBold"
                                       Foreground="{ThemeResource TextBoxDisabledForegroundThemeBrush}"
                                       Text="B" />
                        </Border>
                        <TextBox x:Name="Channel3TextBox"
                                 Grid.Row="4"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 AutomationProperties.Name="Blue Channel"
                                 Style="{StaticResource InputTextBoxStyle}" />
                        <primitives:ColorPickerSlider x:Name="Channel3Slider"
                                                      Grid.Row="4"
                                                      Grid.Column="2"
                                                      Margin="12,0,0,0"
                                                      HorizontalAlignment="Stretch"
                                                      VerticalAlignment="Center"
                                                      AutomationProperties.Name="Blue Channel"
                                                      DefaultForeground="{ThemeResource TextControlForeground}" />
                        <!--  Alpha channel  -->
                        <Border x:Name="AlphaChannelBorder"
                                Grid.Row="5"
                                Grid.Column="0"
                                Height="{Binding ElementName=AlphaChannelTextBox, Path=ActualHeight}"
                                VerticalAlignment="Center"
                                Background="{ThemeResource TextBoxDisabledBackgroundThemeBrush}"
                                BorderBrush="{ThemeResource TextControlBorderBrush}"
                                BorderThickness="1,1,0,1"
                                CornerRadius="2,0,0,2">
                            <TextBlock x:Name="AlphaChannelTextBlock"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       FontWeight="SemiBold"
                                       Foreground="{ThemeResource TextBoxDisabledForegroundThemeBrush}"
                                       Text="A" />
                        </Border>
                        <TextBox x:Name="AlphaChannelTextBox"
                                 Grid.Row="5"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 AutomationProperties.Name="Alpha Channel"
                                 Style="{StaticResource InputTextBoxStyle}" />
                        <primitives:ColorPickerSlider x:Name="AlphaChannelSlider"
                                                      Grid.Row="5"
                                                      Grid.Column="2"
                                                      Margin="12,0,0,0"
                                                      HorizontalAlignment="Stretch"
                                                      VerticalAlignment="Center"
                                                      AutomationProperties.Name="Alpha Channel"
                                                      DefaultForeground="{ThemeResource TextControlForeground}" />
                    </Grid>
                </controls:Case>
            </controls:SwitchPresenter>

            <!--  TODO: Expose resources for the height of this part and the margin  -->
            <Grid x:Name="ColorPreviewGrid"
                  Grid.Row="2"
                  Height="48"
                  Margin="12,0,12,12">
                <Grid.RowDefinitions>
                    <RowDefinition Height="4" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="4" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="3*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <!--  Left-side Preview Darker Shades  -->
                <Border x:Name="CheckeredBackground2Border"
                        Grid.Row="1"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch" />
                <Border x:Name="N2PreviewBorder"
                        Grid.Row="1"
                        Grid.Column="0"
                        VerticalAlignment="Stretch"
                        CornerRadius="2,0,0,2">
                    <Border.Background>
                        <SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Converter={StaticResource ColorToColorShadeConverter}, ConverterParameter='-2'}" />
                    </Border.Background>
                </Border>
                <!--
                    The -1 and +1 accent preview originally had a drop shadow as well.
                    However, due to Z-order issues with the checkered background,
                    shadow and preview border, it would have required its own
                    checkered background. This was judged not worth the performance
                    trade-off so shadows were removed.
                -->
                <Border x:Name="N1PreviewBorder"
                        Grid.Row="1"
                        Grid.Column="1">
                    <Border.Background>
                        <SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Converter={StaticResource ColorToColorShadeConverter}, ConverterParameter='-1'}" />
                    </Border.Background>
                </Border>
                <!--  Right-side Preview Lighter Shades  -->
                <Border x:Name="CheckeredBackground4Border"
                        Grid.Row="1"
                        Grid.Column="3"
                        Grid.ColumnSpan="2"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch" />
                <Border x:Name="P1PreviewBorder"
                        Grid.Row="1"
                        Grid.Column="3">
                    <Border.Background>
                        <SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Converter={StaticResource ColorToColorShadeConverter}, ConverterParameter='1'}" />
                    </Border.Background>
                </Border>
                <Border x:Name="P2PreviewBorder"
                        Grid.Row="1"
                        Grid.Column="4"
                        CornerRadius="0,2,2,0">
                    <Border.Background>
                        <SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Converter={StaticResource ColorToColorShadeConverter}, ConverterParameter='2'}" />
                    </Border.Background>
                </Border>
                <!--  Main Color Preview Box at Bottom  -->
                <!--  Must be last for drop shadow Z-index  -->
                <controls:DropShadowPanel Grid.RowSpan="3"
                                          Grid.Column="2"
                                          HorizontalContentAlignment="Stretch"
                                          VerticalContentAlignment="Stretch"
                                          BlurRadius="10.0"
                                          OffsetX="0.0"
                                          OffsetY="0.0"
                                          ShadowOpacity="0.75"
                                          Color="Black">
                    <Grid>
                        <Border HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Background="{ThemeResource FlyoutPresenterBackground}"
                                CornerRadius="2" />
                        <Border x:Name="CheckeredBackground3Border"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                CornerRadius="2" />
                        <Border x:Name="PreviewBorder"
                                CornerRadius="2">
                            <Border.Background>
                                <SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color}" />
                            </Border.Background>
                        </Border>
                    </Grid>
                </controls:DropShadowPanel>
            </Grid>
            <VisualStateManager.VisualStateGroups>

                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal" />
                    <VisualState x:Name="Disabled">
                        <VisualState.Setters>
                            <Setter Target="RootButton.Background" Value="{ThemeResource ButtonBackgroundDisabled}" />
                            <Setter Target="RootButton.BorderBrush" Value="{ThemeResource ButtonBorderBrushDisabled}" />
                            <Setter Target="DropDownGlyph.Foreground" Value="{ThemeResource ButtonForegroundDisabled}" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="PointerOver">
                        <VisualState.Setters>
                            <Setter Target="RootButton.Background" Value="{ThemeResource ButtonBackgroundPointerOver}" />
                            <Setter Target="RootButton.BorderBrush" Value="{ThemeResource ButtonBorderBrushPointerOver}" />
                            <Setter Target="DropDownGlyph.Foreground" Value="{ThemeResource ButtonForegroundPointerOver}" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <VisualState.Setters>
                            <Setter Target="RootButton.Background" Value="{ThemeResource ButtonBackgroundPressed}" />
                            <Setter Target="RootButton.BorderBrush" Value="{ThemeResource ButtonBorderBrushPressed}" />
                            <Setter Target="DropDownGlyph.Foreground" Value="{ThemeResource ButtonForegroundPressed}" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ColorSpectrumVisibility">
                    <VisualState x:Name="ColorSpectrumVisible" />
                    <VisualState x:Name="ColorSpectrumCollapsed">
                        <VisualState.Setters>
                            <Setter Target="SpectrumListBoxItem.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ColorPaletteVisibility">
                    <VisualState x:Name="ColorPaletteVisible" />
                    <VisualState x:Name="ColorPaletteCollapsed">
                        <VisualState.Setters>
                            <Setter Target="PaletteListBoxItem.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ColorPreviewVisibility">
                    <VisualState x:Name="ColorPreviewVisible" />
                    <VisualState x:Name="ColorPreviewCollapsed">
                        <VisualState.Setters>
                            <Setter Target="ColorPreviewGrid.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="PreviousColorVisibility">
                    <!--  Previous color is not currently supported  -->
                    <VisualState x:Name="PreviousColorCollapsedVertical" />
                    <VisualState x:Name="PreviousColorVisibleVertical" />
                    <VisualState x:Name="PreviousColorCollapsedHorizontal" />
                    <VisualState x:Name="PreviousColorVisibleHorizontal" />
                </VisualStateGroup>
                <VisualStateGroup x:Name="ThirdDimensionSliderVisibility">
                    <VisualState x:Name="ThirdDimensionSliderVisible" />
                    <VisualState x:Name="ThirdDimensionSliderCollapsed">
                        <VisualState.Setters>
                            <Setter Target="ColorSpectrumThirdDimensionSlider.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="AlphaSliderVisibility">
                    <VisualState x:Name="AlphaSliderVisible" />
                    <VisualState x:Name="AlphaSliderCollapsed">
                        <VisualState.Setters>
                            <Setter Target="ColorSpectrumAlphaSlider.Visibility" Value="Collapsed" />
                            <Setter Target="AlphaChannelBorder.Visibility" Value="Collapsed" />
                            <Setter Target="AlphaChannelTextBox.Visibility" Value="Collapsed" />
                            <Setter Target="AlphaChannelSlider.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="MoreButtonVisibility">
                    <!--  More button isn't supported  -->
                    <VisualState x:Name="MoreButtonVisible" />
                    <VisualState x:Name="MoreButtonCollapsed" />
                </VisualStateGroup>
                <VisualStateGroup x:Name="TextEntryGridVisibility">
                    <!--  Text entry grid is not currently supported  -->
                    <VisualState x:Name="TextEntryGridCollapsed" />
                    <VisualState x:Name="TextEntryGridVisible" />
                </VisualStateGroup>
                <VisualStateGroup x:Name="ColorChannelTextInputVisibility">
                    <VisualState x:Name="ColorChannelTextInputVisible" />
                    <VisualState x:Name="ColorChannelTextInputCollapsed">
                        <VisualState.Setters>
                            <Setter Target="ChannelsListBoxItem.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="AlphaTextInputVisibility">
                    <VisualState x:Name="AlphaTextInputVisible" />
                    <VisualState x:Name="AlphaTextInputCollapsed">
                        <VisualState.Setters>
                            <Setter Target="AlphaChannelTextBox.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ColorRepresentationSelected">
                    <VisualState x:Name="RgbSelected" />
                    <VisualState x:Name="HsvSelected">
                        <VisualState.Setters>
                            <Setter Target="Channel1TextBlock.Text" Value="H" />
                            <Setter Target="Channel2TextBlock.Text" Value="S" />
                            <Setter Target="Channel3TextBlock.Text" Value="V" />
                            <Setter Target="Channel1TextBox.(AutomationProperties.Name)" Value="Hue Channel" />
                            <Setter Target="Channel2TextBox.(AutomationProperties.Name)" Value="Saturation Channel" />
                            <Setter Target="Channel3TextBox.(AutomationProperties.Name)" Value="Value Channel" />
                            <Setter Target="Channel1Slider.(AutomationProperties.Name)" Value="Hue Channel" />
                            <Setter Target="Channel2Slider.(AutomationProperties.Name)" Value="Saturation Channel" />
                            <Setter Target="Channel3Slider.(AutomationProperties.Name)" Value="Value Channel" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="HexInputVisibility">
                    <VisualState x:Name="HexInputVisible" />
                    <VisualState x:Name="HexInputCollapsed">
                        <VisualState.Setters>
                            <Setter Target="HexInputGrid.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="AlphaEnabledState">
                    <!--  Not currently supported  -->
                    <VisualState x:Name="AlphaDisabled">
                        <VisualState.Setters>
                            <Setter Target="ColorSpectrumAlphaSlider.Visibility" Value="Collapsed" />
                            <Setter Target="AlphaChannelBorder.Visibility" Value="Collapsed" />
                            <Setter Target="AlphaChannelTextBox.Visibility" Value="Collapsed" />
                            <Setter Target="AlphaChannelSlider.Visibility" Value="Collapsed" />
                        </VisualState.Setters>
                    </VisualState>
                    <VisualState x:Name="AlphaEnabled" />
                </VisualStateGroup>

            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <Style x:Key="PaletteGridViewItemStyle"
           TargetType="GridViewItem">
        <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}" />
        <Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground" Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
        <Setter Property="TabNavigation" Value="Local" />
        <Setter Property="IsHoldingEnabled" Value="True" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="0" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="MinWidth" Value="10" />
        <Setter Property="MinHeight" Value="10" />
        <Setter Property="AllowDrop" Value="False" />
        <Setter Property="UseSystemFocusVisuals" Value="{StaticResource UseSystemFocusVisuals}" />
        <Setter Property="FocusVisualMargin" Value="-2" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="GridViewItem">
                    <Grid x:Name="ContentBorder"
                          Background="{TemplateBinding Background}"
                          BorderBrush="{TemplateBinding BorderBrush}"
                          BorderThickness="{TemplateBinding BorderThickness}"
                          Control.IsTemplateFocusTarget="True"
                          CornerRadius="{TemplateBinding CornerRadius}"
                          FocusVisualMargin="{TemplateBinding FocusVisualMargin}"
                          RenderTransformOrigin="0.5,0.5">
                        <Grid.RenderTransform>
                            <ScaleTransform x:Name="ContentBorderScale" />
                        </Grid.RenderTransform>
                        <ContentPresenter x:Name="ContentPresenter"
                                          Margin="{TemplateBinding Padding}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          ContentTransitions="{TemplateBinding ContentTransitions}" />
                        <!--
                            The 'Xg' text simulates the amount of space one line of text will occupy.
                            In the DataPlaceholder state, the Content is not loaded yet so we
                            approximate the size of the item using placeholder text.
                        -->
                        <TextBlock x:Name="PlaceholderTextBlock"
                                   Margin="{TemplateBinding Padding}"
                                   AutomationProperties.AccessibilityView="Raw"
                                   Foreground="{x:Null}"
                                   IsHitTestVisible="False"
                                   Text="Xg"
                                   Visibility="Collapsed" />
                        <Rectangle x:Name="PlaceholderRect"
                                   Fill="{ThemeResource ListViewItemPlaceholderBackground}"
                                   Visibility="Collapsed" />
                        <Rectangle x:Name="BorderRectangle"
                                   IsHitTestVisible="False"
                                   Opacity="0"
                                   Stroke="{ThemeResource SystemControlHighlightListAccentLowBrush}"
                                   StrokeThickness="2" />
                        <Border x:Name="MultiSelectSquare"
                                Width="20"
                                Height="20"
                                Margin="0,2,2,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Background="{ThemeResource SystemControlBackgroundChromeMediumBrush}"
                                Visibility="Collapsed">
                            <FontIcon x:Name="MultiSelectCheck"
                                      FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                      FontSize="16"
                                      Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}"
                                      Glyph="&#xE73E;"
                                      Opacity="0" />
                        </Border>
                        <Border x:Name="MultiArrangeOverlayTextBorder"
                                Height="20"
                                MinWidth="20"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Background="{ThemeResource SystemControlBackgroundAccentBrush}"
                                BorderBrush="{ThemeResource SystemControlBackgroundChromeWhiteBrush}"
                                BorderThickness="2"
                                IsHitTestVisible="False"
                                Opacity="0">
                            <TextBlock x:Name="MultiArrangeOverlayText"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       AutomationProperties.AccessibilityView="Raw"
                                       IsHitTestVisible="False"
                                       Opacity="0"
                                       Style="{ThemeResource CaptionTextBlockStyle}"
                                       Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=TemplateSettings.DragItemsCount}" />
                        </Border>

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused">

                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BorderRectangle"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Unfocused" />

                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal">

                                    <Storyboard>
                                        <PointerUpThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="PointerOver">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="BorderRectangle"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BorderRectangle"
                                                                       Storyboard.TargetProperty="Stroke">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                       Storyboard.TargetProperty="Foreground">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryThickness">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="2" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <PointerUpThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="Pressed">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="BorderRectangle"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BorderRectangle"
                                                                       Storyboard.TargetProperty="Stroke">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                       Storyboard.TargetProperty="Foreground">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryThickness">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="2" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <PointerDownThemeAnimation TargetName="ContentPresenter" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="Selected">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectCheck"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="BorderRectangle"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BorderRectangle"
                                                                       Storyboard.TargetProperty="Stroke">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{Binding Converter={StaticResource ContrastBrushConverter}, ConverterParameter={ThemeResource TextControlForeground}}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                       Storyboard.TargetProperty="Foreground">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{Binding Converter={StaticResource ContrastBrushConverter}, ConverterParameter={ThemeResource TextControlForeground}}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryThickness">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="2" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MultiSelectSquare"
                                                                       Storyboard.TargetProperty="Background">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{Binding Converter={StaticResource ContrastBrushConverter}, ConverterParameter={ThemeResource TextControlForeground}}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <PointerUpThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="PointerOverSelected">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectCheck"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="BorderRectangle"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BorderRectangle"
                                                                       Storyboard.TargetProperty="Stroke">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{Binding Converter={StaticResource ContrastBrushConverter}, ConverterParameter={ThemeResource TextControlForeground}}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                       Storyboard.TargetProperty="Foreground">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{Binding Converter={StaticResource ContrastBrushConverter}, ConverterParameter={ThemeResource TextControlForeground}}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryThickness">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="2" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MultiSelectSquare"
                                                                       Storyboard.TargetProperty="Background">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{Binding Converter={StaticResource ContrastBrushConverter}, ConverterParameter={ThemeResource TextControlForeground}}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <PointerUpThemeAnimation Storyboard.TargetName="ContentPresenter" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="PressedSelected">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectCheck"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="BorderRectangle"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BorderRectangle"
                                                                       Storyboard.TargetProperty="Stroke">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightListAccentHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                                       Storyboard.TargetProperty="Foreground">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlForegroundBaseHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryBrush">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightListAccentHighBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentBorder"
                                                                       Storyboard.TargetProperty="FocusVisualSecondaryThickness">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="2" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MultiSelectSquare"
                                                                       Storyboard.TargetProperty="Background">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="{ThemeResource SystemControlHighlightAccentBrush}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <PointerDownThemeAnimation TargetName="ContentPresenter" />
                                    </Storyboard>
                                </VisualState>

                            </VisualStateGroup>

                            <VisualStateGroup x:Name="DisabledStates">
                                <VisualState x:Name="Enabled" />

                                <VisualState x:Name="Disabled">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="ContentBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="{ThemeResource ListViewItemDisabledThemeOpacity}"
                                                         Duration="0" />
                                    </Storyboard>
                                </VisualState>

                            </VisualStateGroup>

                            <VisualStateGroup x:Name="MultiSelectStates">
                                <VisualState x:Name="MultiSelectDisabled">

                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MultiSelectSquare"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="Visible" />
                                            <DiscreteObjectKeyFrame KeyTime="0:0:0.333"
                                                                    Value="Collapsed" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <FadeOutThemeAnimation TargetName="MultiSelectSquare" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="MultiSelectEnabled">

                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="MultiSelectSquare"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <FadeInThemeAnimation TargetName="MultiSelectSquare" />
                                    </Storyboard>
                                </VisualState>

                            </VisualStateGroup>

                            <VisualStateGroup x:Name="DataVirtualizationStates">
                                <VisualState x:Name="DataAvailable" />

                                <VisualState x:Name="DataPlaceholder">

                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PlaceholderTextBlock"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PlaceholderRect"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0"
                                                                    Value="Visible" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>

                            </VisualStateGroup>

                            <VisualStateGroup x:Name="ReorderHintStates">
                                <VisualState x:Name="NoReorderHint" />

                                <VisualState x:Name="BottomReorderHint">

                                    <Storyboard>
                                        <DragOverThemeAnimation Direction="Bottom"
                                                                ToOffset="{ThemeResource GridViewItemReorderHintThemeOffset}"
                                                                TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="TopReorderHint">

                                    <Storyboard>
                                        <DragOverThemeAnimation Direction="Top"
                                                                ToOffset="{ThemeResource GridViewItemReorderHintThemeOffset}"
                                                                TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="RightReorderHint">

                                    <Storyboard>
                                        <DragOverThemeAnimation Direction="Right"
                                                                ToOffset="{ThemeResource GridViewItemReorderHintThemeOffset}"
                                                                TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="LeftReorderHint">

                                    <Storyboard>
                                        <DragOverThemeAnimation Direction="Left"
                                                                ToOffset="{ThemeResource GridViewItemReorderHintThemeOffset}"
                                                                TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0:0:0.2"
                                                      To="NoReorderHint" />
                                </VisualStateGroup.Transitions>

                            </VisualStateGroup>

                            <VisualStateGroup x:Name="DragStates">
                                <VisualState x:Name="NotDragging" />

                                <VisualState x:Name="Dragging">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="ContentBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="{ThemeResource ListViewItemDragThemeOpacity}"
                                                         Duration="0" />
                                        <DragItemThemeAnimation TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="DraggingTarget" />

                                <VisualState x:Name="MultipleDraggingPrimary">

                                    <Storyboard>
                                        <!--
                                            These two Opacity animations are required - the FadeInThemeAnimations
                                            on the same elements animate an internal Opacity.
                                        -->
                                        <DoubleAnimation Storyboard.TargetName="MultiArrangeOverlayText"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="MultiArrangeOverlayTextBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectSquare"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectCheck"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="ContentBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="{ThemeResource ListViewItemDragThemeOpacity}"
                                                         Duration="0" />
                                        <FadeInThemeAnimation TargetName="MultiArrangeOverlayText" />
                                        <FadeInThemeAnimation TargetName="MultiArrangeOverlayTextBorder" />
                                        <DragItemThemeAnimation TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="MultipleDraggingSecondary" />

                                <VisualState x:Name="DraggedPlaceholder" />

                                <VisualState x:Name="Reordering">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="ContentBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="{ThemeResource ListViewItemReorderThemeOpacity}"
                                                         Duration="0:0:0.240" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="ReorderingTarget">

                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="ContentBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="{ThemeResource ListViewItemReorderTargetThemeOpacity}"
                                                         Duration="0:0:0.240" />
                                        <DoubleAnimation Storyboard.TargetName="ContentBorderScale"
                                                         Storyboard.TargetProperty="ScaleX"
                                                         To="{ThemeResource ListViewItemReorderTargetThemeScale}"
                                                         Duration="0:0:0.240" />
                                        <DoubleAnimation Storyboard.TargetName="ContentBorderScale"
                                                         Storyboard.TargetProperty="ScaleY"
                                                         To="{ThemeResource ListViewItemReorderTargetThemeScale}"
                                                         Duration="0:0:0.240" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="MultipleReorderingPrimary">

                                    <Storyboard>
                                        <!--
                                            These two Opacity animations are required - the FadeInThemeAnimations
                                            on the same elements animate an internal Opacity.
                                        -->
                                        <DoubleAnimation Storyboard.TargetName="MultiArrangeOverlayText"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="MultiArrangeOverlayTextBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectSquare"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="MultiSelectCheck"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0"
                                                         Duration="0" />
                                        <DoubleAnimation Storyboard.TargetName="ContentBorder"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="{ThemeResource ListViewItemDragThemeOpacity}"
                                                         Duration="0:0:0.240" />
                                        <FadeInThemeAnimation TargetName="MultiArrangeOverlayText" />
                                        <FadeInThemeAnimation TargetName="MultiArrangeOverlayTextBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="ReorderedPlaceholder">

                                    <Storyboard>
                                        <FadeOutThemeAnimation TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="DragOver">

                                    <Storyboard>
                                        <DropTargetItemThemeAnimation TargetName="ContentBorder" />
                                    </Storyboard>
                                </VisualState>

                                <VisualStateGroup.Transitions>
                                    <VisualTransition GeneratedDuration="0:0:0.2"
                                                      To="NotDragging" />
                                </VisualStateGroup.Transitions>

                            </VisualStateGroup>

                        </VisualStateManager.VisualStateGroups>
                    </Grid>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="UnderlineListBoxItemStyle"
           TargetType="ListBoxItem">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="TabNavigation" Value="Local" />
        <Setter Property="Padding" Value="{StaticResource ListBoxItemPadding}" />
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="VerticalContentAlignment" Value="Stretch" />
        <Setter Property="Margin" Value="8,0,8,0" />
        <Setter Property="Padding" Value="24,0,24,0" />
        <Setter Property="MinWidth" Value="100" />
        <Setter Property="UseSystemFocusVisuals" Value="{StaticResource UseSystemFocusVisuals}" />
        <Setter Property="Template" Value="{StaticResource UnderlineListBoxItemTemplate}" />
    </Style>

    <ControlTemplate x:Key="UnderlineListBoxItemTemplate"
                     TargetType="ListBoxItem">
        <Grid x:Name="LayoutRoot"
              Background="{TemplateBinding Background}"
              BorderThickness="{TemplateBinding BorderThickness}">
            <Grid.Resources>
                <Style x:Key="BaseContentPresenterStyle"
                       TargetType="ContentPresenter">
                    <Setter Property="FontFamily" Value="XamlAutoFontFamily" />
                    <Setter Property="FontWeight" Value="SemiBold" />
                    <Setter Property="TextWrapping" Value="Wrap" />
                    <Setter Property="LineStackingStrategy" Value="MaxHeight" />
                    <Setter Property="TextLineBounds" Value="Full" />
                    <Setter Property="OpticalMarginAlignment" Value="TrimSideBearings" />
                </Style>
                <Style x:Key="BodyContentPresenterStyle"
                       BasedOn="{StaticResource BaseContentPresenterStyle}"
                       TargetType="ContentPresenter">
                    <Setter Property="FontWeight" Value="Normal" />
                </Style>
            </Grid.Resources>
            <Rectangle x:Name="PressedBackground"
                       Height="2"
                       Margin="4,0,4,2"
                       VerticalAlignment="Bottom"
                       Control.IsTemplateFocusTarget="True"
                       Fill="Transparent"
                       RadiusX="1"
                       RadiusY="1" />
            <ContentPresenter x:Name="ContentPresenter"
                              Margin="{TemplateBinding Padding}"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              Content="{TemplateBinding Content}"
                              ContentTemplate="{TemplateBinding ContentTemplate}"
                              ContentTransitions="{TemplateBinding ContentTransitions}"
                              Style="{StaticResource BodyContentPresenterStyle}"
                              TextWrapping="NoWrap" />

            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                    <VisualState x:Name="Normal" />

                    <VisualState x:Name="Disabled">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlDisabledBaseMediumLowBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>

                    <VisualState x:Name="PointerOver">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                                                           Storyboard.TargetProperty="Fill">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightListLowBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>

                    <VisualState x:Name="Pressed">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                                                           Storyboard.TargetProperty="Fill">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightListMediumBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>

                    <VisualState x:Name="Selected">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                                                           Storyboard.TargetProperty="Fill">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightListAccentLowBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="SelectedUnfocused">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                                                           Storyboard.TargetProperty="Fill">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightListAccentLowBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="SelectedPointerOver">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                                                           Storyboard.TargetProperty="Fill">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightListAccentMediumBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="SelectedPressed">

                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                                                           Storyboard.TargetProperty="Fill">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightListAccentHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContentPresenter"
                                                           Storyboard.TargetProperty="Foreground">
                                <DiscreteObjectKeyFrame KeyTime="0"
                                                        Value="{ThemeResource SystemControlHighlightAltBaseHighBrush}" />
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>

                </VisualStateGroup>

            </VisualStateManager.VisualStateGroups>
        </Grid>

    </ControlTemplate>

</ResourceDictionary>
